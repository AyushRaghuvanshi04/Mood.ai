# Mood.ai API Documentation

## Overview

Mood.ai provides a RESTful API for generating AI-powered playlists with Spotify integration, multi-language support, and web search verification.

## Base URL

- **Development**: `http://localhost:3000/api`
- **Production**: `https://your-domain.vercel.app/api`

## Authentication

All API endpoints require authentication via NextAuth.js with Spotify OAuth.

## Endpoints

### 1. Generate Playlist

**POST** `/api/generate`

Generates an AI-powered playlist based on mood, language, genre, and time period preferences.

#### Request Body

```json
{
  "prompt": "string",           // Required: Mood description
  "title": "string",            // Optional: Playlist title (default: "My Mood.ai Playlist")
  "description": "string",      // Optional: Playlist description (default: "Generated by Mood.ai")
  "numSongs": "number",         // Optional: Number of songs (5-50, default: 15)
  "isPublic": "boolean",        // Optional: Public playlist (default: true)
  "language": "string",         // Optional: Language/region (hollywood, bollywood, korean, etc.)
  "genre": "string",            // Optional: Genre selection
  "timePeriod": "string"        // Optional: Time period (decade, year, or range)
}
```

#### Language Options

| Value | Label | Description |
|-------|-------|-------------|
| `hollywood` | Hollywood (English) | Western music genres |
| `bollywood` | Bollywood (Hindi) | Indian music genres |
| `korean` | K-Pop (Korean) | Korean music genres |
| `japanese` | J-Pop (Japanese) | Japanese music genres |
| `spanish` | Latin (Spanish) | Latin American genres |
| `french` | French | French music genres |
| `german` | German | German music genres |
| `any` | Any Language | Mixed international genres |

#### Time Period Formats

- **Decade**: `"1990s"`, `"2000s"`, `"2010s"`
- **Specific Year**: `"2020"`, `"2021"`, `"2022"`
- **Year Range**: `"2015-2020"`, `"2000-2010"`

#### Response

```json
{
  "success": true,
  "playlist": {
    "id": "string",
    "name": "string",
    "description": "string",
    "public": "boolean",
    "imageUrl": "string",
    "externalUrl": "string",
    "tracks": [
      {
        "id": "string",
        "title": "string",
        "artist": "string",
        "previewUrl": "string | null",
        "spotifyId": "string | null"
      }
    ],
    "verificationStats": {
      "totalGenerated": "number",
      "verifiedOnSpotify": "number",
      "unverified": "number"
    }
  }
}
```

#### Example Request

```bash
curl -X POST http://localhost:3000/api/generate \
  -H "Content-Type: application/json" \
  -d '{
    "prompt": "Late night drive under city lights",
    "language": "bollywood",
    "genre": "Romantic",
    "timePeriod": "2010s",
    "numSongs": 20
  }'
```

### 2. Create Spotify Playlist

**POST** `/api/spotify/create-playlist`

Creates a playlist on the user's Spotify account.

#### Request Body

```json
{
  "title": "string",            // Required: Playlist title
  "description": "string",      // Required: Playlist description
  "isPublic": "boolean",        // Required: Public playlist
  "tracks": [                   // Required: Array of tracks
    {
      "title": "string",
      "artist": "string"
    }
  ]
}
```

#### Response

```json
{
  "success": true,
  "playlistId": "string",
  "externalUrl": "string"
}
```

### 3. Authentication Endpoints

#### Sign In
**GET** `/api/auth/signin/spotify`

Redirects to Spotify OAuth login.

#### Sign Out
**POST** `/api/auth/signout`

Signs out the current user.

#### Session
**GET** `/api/auth/session`

Returns the current user session.

## Error Responses

### 400 Bad Request
```json
{
  "error": "Invalid request parameters",
  "message": "Detailed error message"
}
```

### 401 Unauthorized
```json
{
  "error": "Authentication required",
  "message": "Please sign in to access this resource"
}
```

### 500 Internal Server Error
```json
{
  "error": "Internal server error",
  "message": "Something went wrong on our end"
}
```

## Rate Limiting

- **Generate Playlist**: 10 requests per minute per user
- **Create Spotify Playlist**: 5 requests per minute per user

## Web Search Verification

When `GOOGLE_SEARCH_API_KEY` and `GOOGLE_SEARCH_ENGINE_ID` are configured, the API automatically verifies songs against Spotify using Google Custom Search API.

### Verification Process

1. **Primary Search**: Searches `open.spotify.com` for exact song matches
2. **Fallback Search**: General web search for Spotify links
3. **ID Extraction**: Extracts Spotify track IDs from search results
4. **Statistics**: Returns verification statistics in the response

## Examples

### Bollywood Romantic Playlist

```bash
curl -X POST http://localhost:3000/api/generate \
  -H "Content-Type: application/json" \
  -d '{
    "prompt": "Romantic dinner with candlelight",
    "language": "bollywood",
    "genre": "Romantic",
    "timePeriod": "2010s",
    "numSongs": 15
  }'
```

### K-Pop Workout Playlist

```bash
curl -X POST http://localhost:3000/api/generate \
  -H "Content-Type: application/json" \
  -d '{
    "prompt": "High-energy workout session",
    "language": "korean",
    "genre": "K-Hip-Hop",
    "timePeriod": "2020s",
    "numSongs": 25
  }'
```

### Latin Party Playlist

```bash
curl -X POST http://localhost:3000/api/generate \
  -H "Content-Type: application/json" \
  -d '{
    "prompt": "Summer beach party vibes",
    "language": "spanish",
    "genre": "Reggaeton",
    "timePeriod": "2015-2020",
    "numSongs": 30
  }'
```

## SDK Examples

### JavaScript/TypeScript

```typescript
// Generate playlist
const response = await fetch('/api/generate', {
  method: 'POST',
  headers: { 'Content-Type': 'application/json' },
  body: JSON.stringify({
    prompt: 'Late night drive under city lights',
    language: 'hollywood',
    genre: 'Indie',
    timePeriod: '2010s',
    numSongs: 20
  })
});

const data = await response.json();
console.log(data.playlist);
```

### Python

```python
import requests

# Generate playlist
response = requests.post('http://localhost:3000/api/generate', json={
    'prompt': 'Late night drive under city lights',
    'language': 'hollywood',
    'genre': 'Indie',
    'timePeriod': '2010s',
    'numSongs': 20
})

data = response.json()
print(data['playlist'])
```

## Support

For API support, please:
1. Check the [GitHub Issues](https://github.com/AyushRaghuvanshi04/Mood.ai/issues)
2. Create a new issue with detailed information
3. Contact: ayush.raghuvanshi2004@gmail.com
